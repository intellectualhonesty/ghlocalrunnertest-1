---
name: Pre Pull Request Check
on:
  pull_request:
    types: ['opened', 'synchronize']
    paths:
      - '.github/**'
      - '**.go'
      - '**.tf'
      - '.github/workflows/**'
      - '**.md'

jobs:
  prepr-check:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3
      - name: block
        run: |
          echo ===> "now sleeping 1m"
          sleep 1m
          export gettoken=$(curl \
             -s \
             -X POST \
             -H "Accept: application/vnd.github.v3+json" \
             -u lonegunmanb:$ACCESS_TOKEN \
             https://api.github.com/repos/lonegunmanb/ghlocalrunnertest/actions/runners/registration-token \
          | jq -r .token)
          cd /actions-runner
          ./config.sh remove --token $gettoken